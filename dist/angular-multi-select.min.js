/*! angular-multi-select 5.3.18 */
var angular_multi_select=angular.module("angular-multi-select",["ng","angular.filter"]);angular_multi_select.directive("angularMultiSelect",["$rootScope","$sce","$timeout","$filter","$interpolate","$cacheFactory",function(a,b,c,d,e,f){"use strict";return{restrict:"AE",scope:{api:"=",inputModel:"=",outputModel:"=",singleOutputModel:"=",onClear:"&",onClose:"&",onSearchChange:"&",onItemClick:"&",onOpen:"&",onReset:"&",onSelectAll:"&",onSelectNone:"&",translation:"="},templateUrl:"angular-multi-select.htm",link:function(g,h,i){i.idProperty=i.idProperty||"angular-multi-select-id",i.selectionMode=i.selectionMode||"multi",i.selectionMode="1"===i.selectionMode?"single":i.selectionMode,i.selectionMode=i.selectionMode.toLowerCase(),i.helperElements=i.helperElements||"reset filter",i.searchProperty=i.searchProperty||"",i.hiddenProperty=i.hiddenProperty||"",i.buttonTemplate=i.buttonTemplate||"angular-multi-select-btn-count.htm",i.buttonLabelSeparator=i.buttonLabelSeparator||'[", ", ""]',i.minSearchLength=parseInt(i.minSearchLength,10)||3,g.delayStart=parseInt(i.delayStart)||0,g.preselectProp=i.preselectProp||"",g.singleOutputProp=i.singleOutputProp||"",g.preselectValue=i.preselectValue||"",g.outputModelProps=i.outputModelProps||"";try{g.outputModelProps=JSON.parse(g.outputModelProps)}catch(j){g.outputModelProps=[]}g.outputModelType=i.outputModelType||"objects",g._shadowModel=[],g.filteredModel=[],g.searchInput={value:""},g.kbFocus=[],g.kbFocusIndex=null,g.visible=!1,g.tickProperty=i.tickProperty,g.idProperty=i.idProperty,g.groupProperty=i.groupProperty,g.itemLabel=h.attr(i.$attr.itemLabel),g._interpolatedItemLabel=e(g.itemLabel),g.buttonLabel=i.hasOwnProperty("buttonLabel")?h.attr(i.$attr.buttonLabel):"",g._interpolatedButtonLabel=e(g.buttonLabel),g.buttonTemplate=i.buttonTemplate,g.buttonLabelSeparator=JSON.parse(i.buttonLabelSeparator),g.hiddenProperty=i.hiddenProperty,g.outputModel=g.outputModel||[],void 0!==g.api&&(g.api={select_all:function(){g.selectAll()},select_none:function(){g.selectNone()},select:function(a){var b=g._getItemById(a);null!==b&&g.clickItem(b,!0)},reset:function(){g.reset()},clear:function(){g.clear()},open:function(){c(function(){g.visible=!0},0)},close:function(){c(function(){g.visible=!1},0)}}),g._trans={selected:"selected",selectAll:"Select all",selectNone:"Select none",reset:"Reset",search:"Search..."},angular.extend(g._trans,g.translation),g.lang={selectAll:b.trustAsHtml(g._trans.selectAll),selectNone:b.trustAsHtml(g._trans.selectNone),reset:b.trustAsHtml(g._trans.reset),search:g._trans.search},g.helperStatus={all:-1!==i.helperElements.search(new RegExp(/\ball\b/))?!0:-1!==i.helperElements.search(new RegExp(/\bnoall\b/))?!1:"single"!==i.selectionMode,none:-1!==i.helperElements.search(new RegExp(/\bnone\b/))?!0:-1!==i.helperElements.search(new RegExp(/\bnonone\b/))?!1:"single"!==i.selectionMode,reset:-1!==i.helperElements.search(new RegExp(/\breset\b/))?!0:-1===i.helperElements.search(new RegExp(/\bnoreset\b/)),filter:-1!==i.helperElements.search(new RegExp(/\bfilter\b/))?!0:-1===i.helperElements.search(new RegExp(/\bnofilter\b/))},g.Math=window.Math,g.uuid=Math.random()+"_",g.c_items_labels=f(g.uuid+"item_labels"),g.c_button_label=f(g.uuid+"button_label"),g.c_has_children=f(g.uuid+"has_children"),g.baseExtend=function(a,b,c){for(var d=a.$$hashKey,e=0,f=b.length;f>e;++e){var h=b[e];if(angular.isObject(h)||angular.isFunction(h))for(var i=Object.keys(h),j=0,k=i.length;k>j;j++){var l=i[j],m=h[l];c&&angular.isObject(m)?(angular.isObject(a[l])||(a[l]=angular.isArray(m)?[]:{}),g.baseExtend(a[l],[m],!0)):a[l]=m}}return d?a.$$hashKey=d:delete a.$$hashKey,a},g.merge=function(a){return g.baseExtend(a,[].slice.call(arguments,1),!0)},g.deepCompare=function(a,b){if(null===a||void 0===a||null===b||void 0===b)return a===b;if(a.constructor!==b.constructor)return!1;if(a instanceof Function)return a===b;if(a instanceof RegExp)return a===b;if(a===b||a.valueOf()===b.valueOf())return!0;if(Array.isArray(a)&&a.length!==b.length)return!1;if(a instanceof Date)return!1;if(!(a instanceof Object))return!1;if(!(b instanceof Object))return!1;var c=Object.keys(a);return Object.keys(b).every(function(a){return-1!==c.indexOf(a)})&&c.every(function(c){return g.deepCompare(a[c],b[c])})},g.not=function(a){return function(b){return!a(b)}},g._walk=function(a,b,c){var d;if(angular.isArray(a)){var e=[];for(d in a){var f=g._walk(a[d],b,c);null!==f&&e.push(f)}return e.length>0?e:null}if(angular.isObject(a)){c=c||function(){return!0};var h=c(a);if(a.hasOwnProperty(b)&&angular.isArray(a[b])){var i=[];for(d in a[b]){var j=g._walk(a[b][d],b,c);null!==j&&i.push(j)}i.length!==a[b].length&&(a[b]=i),h=i.length>0}return h?a:null}},g._syncModels=function(a,b){g._walk(b,i.groupProperty,function(b){return g._walk(a,i.groupProperty,function(a){return a[i.idProperty]===b[i.idProperty]&&(a[i.tickProperty]=b[i.tickProperty]),!0}),!0})},g._getItemById=function(a,b){b=b||g.filteredModel;var c=null;return g._walk(b,i.groupProperty,function(b){return b[i.idProperty]===a&&(c=b),!0}),c},g._getParent=function(a,b){var c=null,d=!1,e=null;return g._walk(a,i.groupProperty,function(a){return d===!0?!0:(g._hasChildren(a,!1)>0&&a[i.idProperty]!==b[i.idProperty]&&(e=a),a[i.idProperty]===b[i.idProperty]&&(c=e,d=!0),!0)}),c},g._getLeafs=function(a){var b=[];return g._walk(a,i.groupProperty,function(a){return 0===g._hasChildren(a,!1)&&b.push(a),!0}),b},g._getNodes=function(a){var b=[];return g._walk(a,i.groupProperty,function(a){return g._hasChildren(a,!1)>0&&b.push(a),!0}),b},g._createButtonLabel=function(a,c){var d=g.c_button_label.get(a.length+"_"+a[c][i.idProperty]+"_"+c);if(void 0!==d)return d;var e=a[c],f=null;if(g.hasOwnProperty("$parent")&&void 0!==g.$parent)for(f=g.$parent;null!==f;){var h={};for(var j in f)f.hasOwnProperty(j)&&"this"!==j&&"$"!==j[0]&&"function"!=typeof f[j]&&(h[j]=f[j]);e=g.merge({},h,e),f=f.hasOwnProperty("$parent")&&void 0!==g.$parent?f.$parent:null}var k=g._interpolatedButtonLabel(e),l="";a.length>1&&(l+=c==a.length-1?g.buttonLabelSeparator[1]:g.buttonLabelSeparator[0]);var m=b.trustAsHtml(k+l);return g.c_button_label.put(a.length+"_"+a[c][i.idProperty]+"_"+c,m),m},g._createItemLabel=function(a){var c=g.c_items_labels.get(a[i.idProperty]);if(void 0!==c)return c;var d=a,e=null;if(g.hasOwnProperty("$parent")&&void 0!==g.$parent)for(e=g.$parent;null!==e;){var f={};for(var h in e)e.hasOwnProperty(h)&&"this"!==h&&"$"!==h[0]&&"function"!=typeof e[h]&&(f[h]=e[h]);d=g.merge({},f,d),e=e.hasOwnProperty("$parent")&&void 0!==g.$parent?e.$parent:null}var j=g._interpolatedItemLabel(d),k=b.trustAsHtml(j);return g.c_items_labels.put(a[i.idProperty],k),k},g._hasChildren=function(a,b){if(b=b||!1,b===!1&&a.hasOwnProperty(i.groupProperty)&&angular.isArray(a[i.groupProperty])&&a[i.groupProperty].length>0)return 1;var c=g.c_has_children.get(a[i.idProperty]);if(void 0!==c)return c;var d=-1;return g._walk(a,i.groupProperty,function(){return d++,!0}),g.c_button_label.put(a[i.idProperty],d),d},g._isHidden=function(a){return a[i.hiddenProperty]===!0},g._isChecked=function(a){return a[i.tickProperty]===!0},g._areAllChecked=function(a){var b=0,c=0;return g._walk(a,i.groupProperty,function(a){return 0===g._hasChildren(a,!1)&&(g._isChecked(a)&&b++,c++),!0}),c===b?b:b>0?-b:0},g._enforceProps=function(a){var b=[];g._walk(a,i.groupProperty,function(a){return(a.hasOwnProperty(i.idProperty)===!1||-1!==b.indexOf(a[i.idProperty]))&&(a[i.idProperty]=Math.floor(1e8*Math.random()+1)),b.push(a[i.idProperty]),a[i.tickProperty]=a[i.tickProperty]||!1,a._check_time=0,a[i.hiddenProperty]=a[i.hiddenProperty]||!1,!0})},g._enforceChecks=function(a){var b=0,c=g._getLeafs(a),d=[];c.sort(function(a,b){return a._check_time>b._check_time});var e=!1;for(var f in c){var h=g._isChecked(c[f]);if(h&&(b++,d.push(f)),b>1&&"single"===i.selectionMode){e=!0,g._uncheckAll(a);break}"single"!==i.selectionMode&&"multi"!==i.selectionMode&&b>parseInt(i.selectionMode)&&(b--,g._uncheck(c[d.shift()]))}e!==!0&&angular.forEach(g._getNodes(a),function(a){a[i.tickProperty]=0!==g._areAllChecked(a)})},g._flipCheck=function(a){if(g._hasChildren(a)>0){var b=0===Math.abs(g._areAllChecked(a));g._walk(a,i.groupProperty,function(a){return b?g._check(a):g._uncheck(a),!0})}else g._isChecked(a)?g._uncheck(a):g._check(a)},g._uncheck=function(a){a[i.tickProperty]=!1},g._uncheckAll=function(a){g._walk(a,i.groupProperty,function(a){return g._uncheck(a),!0})},g._check=function(a){a[i.tickProperty]=!0,a._check_time=(new Date).getTime()},g._checkAll=function(a){g._walk(a,i.groupProperty,function(a){return g._check(a),!0})},g.clickItem=function(a,b){b===!0&&(g.kbFocusIndex=null),"single"===i.selectionMode&&0!==g._areAllChecked(g._shadowModel)&&(0!==g._hasChildren(a,!1)&&1!==g._hasChildren(a)||!g._isChecked(a))&&(g._uncheckAll(g._shadowModel),g._uncheckAll(g.filteredModel)),g._flipCheck(a),"single"===i.selectionMode&&(g.visible=!1),c(function(){g.onItemClick({item:angular.copy(a)})},0)},g._filter=function(a){if(""===i.searchProperty||void 0===g.searchInput.value||""===g.searchInput.value)return!0;var b=angular.extend({},a);b[i.searchProperty]=d("latinize")(b[i.searchProperty]);var c=g.searchInput.value;c=d("latinize")(c);var e=d("fuzzyBy")([b],i.searchProperty,c);return e.length>0},g.fillShadowModel=function(){g._shadowModel=angular.copy(g.inputModel),g._enforceProps(g._shadowModel);try{g.preselectValue=JSON.parse(g.preselectValue)}catch(a){g.preselectValue=[g.preselectValue]}""!==g.preselectProp&&angular.isArray(g.preselectValue)&&!angular.equals(g.preselectValue,[""])&&g._walk(g._shadowModel,i.groupProperty,function(a){return a.hasOwnProperty(g.preselectProp)&&-1!==g.preselectValue.indexOf(a[g.preselectProp])&&g._check(a),!0}),g._enforceChecks(g._shadowModel),g.fillFilteredModel()},g.selectAll=function(){g._checkAll(g.filteredModel),c(function(){g.onSelectAll()},0)},g.selectNone=function(){g._uncheckAll(g.filteredModel),c(function(){g.onSelectNone()},0)},g.reset=function(){g.fillShadowModel(),c(function(){g.onReset()},0)},g.clear=function(){g.searchInput.value="",c(function(){g.onClear()},0)},g.fillFilteredModel=function(){g.filteredModel=angular.copy(g._shadowModel),g.filteredModel=g._walk(g.filteredModel,i.groupProperty,g._filter)},g.$watch("inputModel",function(a,b){(a||!angular.equals(a,b))&&(g.c_items_labels.removeAll(),g.c_button_label.removeAll(),g.c_has_children.removeAll(),c(function(){g.fillShadowModel()},g.delayStart))},!0),g.$watch("filteredModel",function(a,b){if(!g.deepCompare(a,b)){g._enforceChecks(g.filteredModel),g._syncModels(g._shadowModel,g.filteredModel);var c=g._walk(angular.copy(g._shadowModel),i.groupProperty,function(a){return g.kbFocus.push(a[i.idProperty]),g._isChecked(a)});c=null===c?[]:c;var d=angular.copy(c);g.deepCompare(angular.copy(g._shadowOutputModel),d)||(g._shadowOutputModel=d);var e=angular.copy(c);if(g.outputModelProps.length>0&&g._walk(e,i.groupProperty,function(a){return angular.forEach(a,function(b,c){-1===g.outputModelProps.indexOf(c)&&c!==i.groupProperty&&delete a[c]}),!0}),"arrays"===g.outputModelType&&g.outputModelProps.length>0){var f=[];g._walk(e,i.groupProperty,function(a){var b=[];if(0===g._hasChildren(a))return angular.forEach(g.outputModelProps,function(c){b.push(a[c])}),f.push(b),!0}),e=f}else if("array"===g.outputModelType&&g.outputModelProps.length>0){var h=[];g._walk(e,i.groupProperty,function(a){return 0===g._hasChildren(a)?(angular.forEach(g.outputModelProps,function(b){h.push(a[b])}),!0):void 0}),e=h}var j=angular.copy(g.outputModel);if(g.deepCompare(j,e)||(g.outputModel=e),void 0!==g.singleOutputModel&&c.length>0){var k=c[0];0!==g._hasChildren(k)&&(k=g._getLeafs(k)[0]);var l=k;""!==g.singleOutputProp&&k.hasOwnProperty(g.singleOutputProp)&&(l=k[g.singleOutputProp]),g.singleOutputModel=l}g.kbFocus=[],g.helperStatus.all===!0&&g.kbFocus.push("all"),g.helperStatus.none===!0&&g.kbFocus.push("none"),g.helperStatus.reset===!0&&g.kbFocus.push("reset"),g.helperStatus.filter===!0&&(g.kbFocus.push("input"),g.kbFocus.push("clear")),g._walk(g.filteredModel,i.groupProperty,function(a){return g.kbFocus.push(a[i.idProperty]),!0})}},!0),g.$watch("searchInput.value",function(a,b){angular.equals(a,b)||((a.length>i.minSearchLength||a.length<b.length&&b.length>=0)&&(g.kbFocusIndex=null,g.fillFilteredModel()),c(function(){g.onSearchChange({input:a})},0))}),a.$on("angular-multi-select-on-visible-change",function(a,b){g.$id!==b.id&&b.visible===!0&&g.visible===!0&&(g.visible=!g.visible)}),g.$watch("visible",function(b,d){angular.equals(b,d)||b!==!0?angular.equals(b,d)||b!==!1||(g.stopListeningMouseEvents(),g.stopListeningMouseEvents=null,g.stopListeningKeyboardEvents(),g.stopListeningKeyboardEvents=null,c(function(){g._close_pos(),g.onClose()},0)):(g.kbFocusIndex=g.kbFocus.indexOf("input")||0,a.$emit("angular-multi-select-on-visible-change",{visible:g.visible,id:g.$id}),g.stopListeningMouseEvents=g.$on("angular-multi-select-click",function(a,b){for(var c=!1,d=b.event.target;d;){if(void 0!==angular.element(d).attr("angular-multi-select")){c=!0;break}d=d.parentNode}c===!1&&(g.visible=!1,g.$apply())}),g.stopListeningKeyboardEvents=g.$on("angular-multi-select-keydown",function(a,b){var d=b.event.keyCode?b.event.keyCode:b.event.which,e=g.kbFocusIndex,f=!1;if(27===d)g.visible=!1;else if(13===d||32===d){var h=g.kbFocus[g.kbFocusIndex];angular.isNumber(h)&&g._walk(g.filteredModel,i.groupProperty,function(a){return a[i.idProperty]===h&&g.clickItem(a),!0})}else 40===d||39===d||!b.event.shiftKey&&9==d?(null===g.kbFocusIndex&&(g.kbFocusIndex=-1),g.kbFocusIndex<g.kbFocus.length-1?g.kbFocusIndex++:g.kbFocusIndex=0):38===d||37===d||b.event.shiftKey&&9==d?(null===g.kbFocusIndex&&(g.kbFocusIndex=1),g.kbFocusIndex>0?g.kbFocusIndex--:g.kbFocusIndex=g.kbFocus.length-1):f=!0;g.$apply(),f===!0&&c(function(){g.kbFocusIndex=e},0)}),c(function(){g._open_pos(),g.onOpen()},0))}),h.on("$destroy",function(){g.stopListeningMouseEvents&&g.stopListeningMouseEvents(),g.stopListeningKeyboardEvents&&g.stopListeningKeyboardEvents(),g._shadowModel=[],g.filteredModel=[],g.$destroy()}),g._open_pos=function(){var a=angular.element(h[0].querySelector(".ams_layer")),b=a[0].getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,i=d.clientLeft||c.clientLeft||0,j=Math.round(b.top+e-g),k=Math.round(b.left+f-i),l=window.innerHeight-j-b.height,m=window.innerWidth-k-b.width,n="";0>l&&j>=b.height&&(n+="position_top "),0>m&&k>b.width&&(n+="position_left "),a.addClass(n)},g._close_pos=function(){var a=angular.element(h[0].querySelector(".ams_layer"));a.removeClass("position_top"),a.removeClass("position_left")}}}}]),angular_multi_select.directive("angularMultiSelectKeyTrap",function(){"use strict";return function(a,b){b.bind("keydown",function(b){a.$broadcast("angular-multi-select-keydown",{event:b})})}}),angular_multi_select.directive("angularMultiSelectMouseTrap",function(){"use strict";return function(a,b){b.bind("click",function(b){a.$broadcast("angular-multi-select-click",{event:b})})}}),angular_multi_select.directive("setFocus",["$timeout",function(a){"use strict";return function(b,c,d){d.setFocus=d.setFocus||!1,b.$watch(d.setFocus,function(b){a(function(){b?c[0].focus():c[0].blur()})},!0)}}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_btn_template_repeat'>{{ Math.abs(_areAllChecked(filteredModel)) }} {{ _trans.selected }}</div><span class='caret'></span>";a.put("angular-multi-select-btn-count.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_btn_template_repeat' ng-show='(_getLeafs(_shadowOutputModel) | filter:search ).length === 0'>0 {{ _trans.selected }}</div><div class='ams_btn_template_repeat' ng-repeat='obj in objs = (_getLeafs(_shadowOutputModel) | filter:search )' ng-bind-html='_createButtonLabel(objs, $index)'></div><span class='caret'></span>";a.put("angular-multi-select-btn-data.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_item' ng-click='clickItem(item, true);' ng-class='{ams_selected: item[tickProperty], ams_group:_hasChildren(item, false) > 0, ams_focused: kbFocus[kbFocusIndex] === item[idProperty]}'><div ng-bind-html='_createItemLabel(item)'></div><span class='ams_tick' ng-if='item[tickProperty] === true'></span></div><ul ng-if='item.sub'><li ng-repeat='item in item[groupProperty] | filter: not(_isHidden)' ng-include=\"'angular-multi-select-item.htm'\"></li></ul>";a.put("angular-multi-select-item.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<span class=\"ams\"><button class='ams_btn' type='button' ng-click='visible = !visible'><div class='ams_btn_template' ng-include src='buttonTemplate'></div></button>"+'<div class="ams_layer" ng-show="visible"><div class="ams_helpers_container" ng-if="helperStatus.filter || helperStatus.all || helperStatus.none || helperStatus.reset "><div class="ams_row" ng-if="helperStatus.all || helperStatus.none || helperStatus.reset "><button type="button" class="ams_helper_btn ams_selectall"ng-if="helperStatus.all" ng-click="selectAll()" ng-bind-html="lang.selectAll" set-focus="kbFocus[kbFocusIndex] === \'all\'""></button><button type="button" class="ams_helper_btn ams_selectnone"ng-if="helperStatus.none" ng-click="selectNone()" ng-bind-html="lang.selectNone" set-focus="kbFocus[kbFocusIndex] === \'none\'"></button><button type="button" class="ams_helper_btn reset ams_reset"ng-if="helperStatus.reset" ng-click="reset()" ng-bind-html="lang.reset" set-focus="kbFocus[kbFocusIndex] === \'reset\'"></button></div><div class="ams_row ams_search" ng-if="helperStatus.filter"><input placeholder="{{ lang.search }}" type="text" ng-model="searchInput.value" class="inputFilter ams_filter" set-focus="kbFocus[kbFocusIndex] === \'input\'"/><button type="button" class="ams_helper_btn ams_clear" ng-click="clear()" set-focus="kbFocus[kbFocusIndex] === \'clear\'"></button> </div> </div> <div class="ams_items_container"><ul><li ng-repeat=\'item in filteredModel | filter: not(_isHidden)\' ng-include="\'angular-multi-select-item.htm\'"></li></ul></div></div></span>';a.put("angular-multi-select.htm",b)}]);