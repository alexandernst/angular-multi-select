/*! angular-multi-select 5.3.3 */
var angular_multi_select=angular.module("angular-multi-select",["ng","angular.filter"]);angular_multi_select.directive("angularMultiSelect",["$rootScope","$sce","$timeout","$filter","$interpolate",function(a,b,c,d,e){"use strict";return{restrict:"AE",scope:{api:"=",inputModel:"=",outputModel:"=",onClear:"&",onClose:"&",onSearchChange:"&",onItemClick:"&",onOpen:"&",onReset:"&",onSelectAll:"&",onSelectNone:"&",translation:"="},templateUrl:"angular-multi-select.htm",link:function(f,g,h){h.idProperty=h.idProperty||"angular-multi-select-id",h.selectionMode=h.selectionMode||"multi",h.selectionMode=h.selectionMode.toLowerCase(),h.helperElements=h.helperElements||"reset filter",h.searchProperty=h.searchProperty||"",h.hiddenProperty=h.hiddenProperty||"",h.buttonTemplate=h.buttonTemplate||"angular-multi-select-btn-count.htm",h.buttonLabelSeparator=h.buttonLabelSeparator||'[", ", ""]',h.minSearchLength=parseInt(h.minSearchLength,10)||3,f._shadowModel=[],f.filteredModel=[],f.searchInput={value:""},f.kbFocus=[],f.kbFocusIndex=null,f.visible=!1,f.tickProperty=h.tickProperty,f.idProperty=h.idProperty,f.groupProperty=h.groupProperty,f.itemLabel=g.attr(h.$attr.itemLabel),f._interpolatedItemLabel=e(f.itemLabel),f.buttonLabel=h.hasOwnProperty("buttonLabel")?g.attr(h.$attr.buttonLabel):"",f._interpolatedButtonLabel=e(f.buttonLabel),f.buttonTemplate=h.buttonTemplate,f.buttonLabelSeparator=JSON.parse(h.buttonLabelSeparator),f.hiddenProperty=h.hiddenProperty,void 0!==f.api&&(f.api={select_all:function(){f.selectAll()},select_none:function(){f.selectNone()},select:function(a){var b=f._getItemById(a);null!==b&&f.clickItem(b,!0)},reset:function(){f.reset()},clear:function(){f.clear()},open:function(){c(function(){f.visible=!0},0)},close:function(){c(function(){f.visible=!1},0)}}),f._trans={selected:"selected",selectAll:"Select all",selectNone:"Select none",reset:"Reset",search:"Search..."},angular.extend(f._trans,f.translation),f.lang={selectAll:b.trustAsHtml(f._trans.selectAll),selectNone:b.trustAsHtml(f._trans.selectNone),reset:b.trustAsHtml(f._trans.reset),search:f._trans.search},f.helperStatus={all:-1!==h.helperElements.search(new RegExp(/\ball\b/))?!0:-1!==h.helperElements.search(new RegExp(/\bnoall\b/))?!1:"multi"===h.selectionMode,none:-1!==h.helperElements.search(new RegExp(/\bnone\b/))?!0:-1!==h.helperElements.search(new RegExp(/\bnonone\b/))?!1:"multi"===h.selectionMode,reset:-1!==h.helperElements.search(new RegExp(/\breset\b/))?!0:-1===h.helperElements.search(new RegExp(/\bnoreset\b/)),filter:-1!==h.helperElements.search(new RegExp(/\bfilter\b/))?!0:-1===h.helperElements.search(new RegExp(/\bnofilter\b/))},f.Math=window.Math,f.baseExtend=function(a,b,c){for(var d=a.$$hashKey,e=0,g=b.length;g>e;++e){var h=b[e];if(angular.isObject(h)||angular.isFunction(h))for(var i=Object.keys(h),j=0,k=i.length;k>j;j++){var l=i[j],m=h[l];c&&angular.isObject(m)?(angular.isObject(a[l])||(a[l]=angular.isArray(m)?[]:{}),f.baseExtend(a[l],[m],!0)):a[l]=m}}return d?a.$$hashKey=d:delete a.$$hashKey,a},f.merge=function(a){return f.baseExtend(a,[].slice.call(arguments,1),!0)},f.not=function(a){return function(b){return!a(b)}},f._walk=function(a,b,c){if(angular.isArray(a)){var d=[];return angular.forEach(a,function(a){var e=f._walk(a,b,c);null!==e&&d.push(e)}),d.length>0?d:null}if(angular.isObject(a)){c=c||function(){return!0};var e=c(a);if(a.hasOwnProperty(b)&&angular.isArray(a[b])){var g=[];angular.forEach(a[b],function(a){var d=f._walk(a,b,c);null!==d&&g.push(d)}),g.length!==a[b].length&&(a[b]=g),e=g.length>0}return e?a:null}},f._syncModels=function(a,b){f._walk(b,h.groupProperty,function(b){return f._walk(a,h.groupProperty,function(a){return a[h.idProperty]===b[h.idProperty]&&(a[h.tickProperty]=b[h.tickProperty]),!0}),!0})},f._getItemById=function(a,b){b=b||f.filteredModel;var c=null;return f._walk(b,h.groupProperty,function(b){return b[h.idProperty]===a&&(c=b),!0}),c},f._getParent=function(a,b){var c=null,d=!1,e=null;return f._walk(a,h.groupProperty,function(a){return d===!0?!0:(f._hasChildren(a,!1)>0&&a[h.idProperty]!==b[h.idProperty]&&(e=a),a[h.idProperty]===b[h.idProperty]&&(c=e,d=!0),!0)}),c},f._getLeafs=function(a){var b=[];return f._walk(a,h.groupProperty,function(a){return 0===f._hasChildren(a,!1)&&b.push(a),!0}),b},f._getNodes=function(a){var b=[];return f._walk(a,h.groupProperty,function(a){return f._hasChildren(a,!1)>0&&b.push(a),!0}),b},f._createButtonLabel=function(a,c){var d=a[c];if(f.hasOwnProperty("$parent")&&void 0!==f.$parent){var e={};for(var g in f.$parent)f.$parent.hasOwnProperty(g)&&"this"!==g&&"$"!==g[0]&&"function"!=typeof f.$parent[g]&&(e[g]=f.$parent[g]);d=f.merge({},e,d)}var h=f._interpolatedButtonLabel(d),i="";return a.length>1&&(i+=c==a.length-1?f.buttonLabelSeparator[1]:f.buttonLabelSeparator[0]),b.trustAsHtml(h+i)},f._createItemLabel=function(a){var c=angular.extend({},f.$parent,a),d=f._interpolatedItemLabel(c);return b.trustAsHtml(d)},f._hasChildren=function(a,b){if(b=b||!1,b===!1&&a.hasOwnProperty(h.groupProperty)&&angular.isArray(a[h.groupProperty])&&a[h.groupProperty].length>0)return 1;var c=-1;return f._walk(a,h.groupProperty,function(){return c++,!0}),c},f._isHidden=function(a){return a[h.hiddenProperty]===!0},f._isChecked=function(a){return a[h.tickProperty]===!0},f._areAllChecked=function(a){var b=0,c=0;return f._walk(a,h.groupProperty,function(a){return 0===f._hasChildren(a,!1)&&(f._isChecked(a)&&b++,c++),!0}),c===b?b:b>0?-b:0},f._enforceProps=function(a){var b=[];f._walk(a,h.groupProperty,function(a){return(a.hasOwnProperty(h.idProperty)===!1||-1!==b.indexOf(a[h.idProperty]))&&(a[h.idProperty]=Math.floor(1e8*Math.random()+1)),b.push(a[h.idProperty]),a[h.tickProperty]=a[h.tickProperty]||!1,a[h.hiddenProperty]=a[h.hiddenProperty]||!1,!0})},f._enforceChecks=function(a){var b=0,c=f._getLeafs(a),d=!1;if(angular.forEach(c,function(c){if(d!==!0){var e=f._isChecked(c);e&&b++,b>1&&"single"===h.selectionMode&&(d=!0,f._uncheckAll(a))}}),d!==!0){var e=f._getNodes(a);angular.forEach(e,function(a){a[h.tickProperty]=0!==f._areAllChecked(a)})}},f._flipCheck=function(a){if(f._hasChildren(a)>0){var b=0===Math.abs(f._areAllChecked(a));f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=b,!0})}else a[h.tickProperty]=!f._isChecked(a)},f._uncheckAll=function(a){f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=!1,!0})},f._checkAll=function(a){f._walk(a,h.groupProperty,function(a){return a[h.tickProperty]=!0,!0})},f.clickItem=function(a,b){b===!0&&(f.kbFocusIndex=null),"single"===h.selectionMode&&0!==f._areAllChecked(f._shadowModel)&&(0!==f._hasChildren(a,!1)&&1!==f._hasChildren(a)||!f._isChecked(a))&&(f._uncheckAll(f._shadowModel),f._uncheckAll(f.filteredModel)),f._flipCheck(a),f._enforceChecks(f.filteredModel),"single"===h.selectionMode&&(f.visible=!1),c(function(){f.onItemClick({item:angular.copy(a)})},0)},f._filter=function(a){if(""===h.searchProperty||void 0===f.searchInput.value||""===f.searchInput.value)return!0;var b=angular.extend({},a);b[h.searchProperty]=d("latinize")(b[h.searchProperty]);var c=f.searchInput.value;c=d("latinize")(c);var e=d("fuzzyBy")([b],h.searchProperty,c);return e.length>0},f.fillShadowModel=function(){f._shadowModel=angular.copy(f.inputModel),f._enforceProps(f._shadowModel),f._enforceChecks(f._shadowModel),f.fillFilteredModel()},f.selectAll=function(){f._checkAll(f.filteredModel),c(function(){f.onSelectAll()},0)},f.selectNone=function(){f._uncheckAll(f.filteredModel),c(function(){f.onSelectNone()},0)},f.reset=function(){f.fillShadowModel(),c(function(){f.onReset()},0)},f.clear=function(){f.searchInput.value="",c(function(){f.onClear()},0)},f.fillFilteredModel=function(){f.filteredModel=angular.copy(f._shadowModel),f.filteredModel=f._walk(f.filteredModel,h.groupProperty,f._filter)},f.$watch("inputModel",function(a,b){(a||!angular.equals(a,b))&&f.fillShadowModel()},!0),f.$watch("filteredModel",function(a){if(a){f._enforceChecks(f.filteredModel),f._syncModels(f._shadowModel,f.filteredModel);var b=f._walk(angular.copy(f._shadowModel),h.groupProperty,function(a){return f.kbFocus.push(a[h.idProperty]),f._isChecked(a)});f.outputModel=null===b?[]:b,f.kbFocus=[],f.helperStatus.all===!0&&f.kbFocus.push("all"),f.helperStatus.none===!0&&f.kbFocus.push("none"),f.helperStatus.reset===!0&&f.kbFocus.push("reset"),f.helperStatus.filter===!0&&(f.kbFocus.push("input"),f.kbFocus.push("clear")),f._walk(f.filteredModel,h.groupProperty,function(a){return f.kbFocus.push(a[h.idProperty]),!0})}},!0),f.$watch("searchInput.value",function(a,b){angular.equals(a,b)||((a.length>h.minSearchLength||a.length<b.length&&b.length>=0)&&(f.kbFocusIndex=null,f.fillFilteredModel()),c(function(){f.onSearchChange({input:a})},0))}),a.$on("angular-multi-select-on-visible-change",function(a,b){f.$id!==b.id&&b.visible===!0&&f.visible===!0&&(f.visible=!f.visible)}),f.$watch("visible",function(b,d){angular.equals(b,d)||b!==!0?angular.equals(b,d)||b!==!1||(f.stopListeningMouseEvents(),f.stopListeningMouseEvents=null,f.stopListeningKeyboardEvents(),f.stopListeningKeyboardEvents=null,c(function(){f._close_pos(),f.onClose()},0)):(f.kbFocusIndex=f.kbFocus.indexOf("input")||0,a.$emit("angular-multi-select-on-visible-change",{visible:f.visible,id:f.$id}),f.stopListeningMouseEvents=f.$on("angular-multi-select-click",function(a,b){for(var c=!1,d=b.event.target;d;){if(void 0!==angular.element(d).attr("angular-multi-select")){c=!0;break}d=d.parentNode}c===!1&&(f.visible=!1,f.$apply())}),f.stopListeningKeyboardEvents=f.$on("angular-multi-select-keydown",function(a,b){var d=b.event.keyCode?b.event.keyCode:b.event.which,e=f.kbFocusIndex,g=!1;if(27===d)f.visible=!1;else if(13===d||32===d){var i=f.kbFocus[f.kbFocusIndex];angular.isNumber(i)&&f._walk(f.filteredModel,h.groupProperty,function(a){return a[h.idProperty]===i&&f.clickItem(a),!0})}else 40===d||39===d||!b.event.shiftKey&&9==d?(null===f.kbFocusIndex&&(f.kbFocusIndex=-1),f.kbFocusIndex<f.kbFocus.length-1?f.kbFocusIndex++:f.kbFocusIndex=0):38===d||37===d||b.event.shiftKey&&9==d?(null===f.kbFocusIndex&&(f.kbFocusIndex=1),f.kbFocusIndex>0?f.kbFocusIndex--:f.kbFocusIndex=f.kbFocus.length-1):g=!0;f.$apply(),g===!0&&c(function(){f.kbFocusIndex=e},0)}),c(function(){f._open_pos(),f.onOpen()},0))}),g.on("$destroy",function(){f.stopListeningMouseEvents&&f.stopListeningMouseEvents(),f.stopListeningKeyboardEvents&&f.stopListeningKeyboardEvents(),f._shadowModel=[],f.filteredModel=[],f.$destroy()}),f._open_pos=function(){var a=angular.element(g[0].querySelector(".ams_layer")),b=a[0].getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,h=d.clientTop||c.clientTop||0,i=d.clientLeft||c.clientLeft||0,j=Math.round(b.top+e-h),k=Math.round(b.left+f-i),l=window.innerHeight-j-b.height,m=window.innerWidth-k-b.width,n="";0>l&&j>=b.height&&(n+="position_top "),0>m&&k>b.width&&(n+="position_left "),a.addClass(n)},f._close_pos=function(){var a=angular.element(g[0].querySelector(".ams_layer"));a.removeClass("position_top"),a.removeClass("position_left")}}}}]),angular_multi_select.directive("angularMultiSelectKeyTrap",function(){"use strict";return function(a,b){b.bind("keydown",function(b){a.$broadcast("angular-multi-select-keydown",{event:b})})}}),angular_multi_select.directive("angularMultiSelectMouseTrap",function(){"use strict";return function(a,b){b.bind("click",function(b){a.$broadcast("angular-multi-select-click",{event:b})})}}),angular_multi_select.directive("setFocus",["$timeout",function(a){"use strict";return function(b,c,d){d.setFocus=d.setFocus||!1,b.$watch(d.setFocus,function(b){a(function(){b?c[0].focus():c[0].blur()})},!0)}}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_btn_template_repeat'>{{ Math.abs(_areAllChecked(filteredModel)) }} {{ _trans.selected }}</div><span class='caret'></span>";a.put("angular-multi-select-btn-count.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_btn_template_repeat' ng-repeat='obj in objs = (_getLeafs(outputModel) | filter:search )' ng-bind-html='_createButtonLabel(objs, $index)'></div><span class='caret'></span>";a.put("angular-multi-select-btn-data.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<div class='ams_item' ng-click='clickItem(item, true);' ng-class='{ams_selected: item[tickProperty], ams_group:_hasChildren(item, false) > 0, ams_focused: kbFocus[kbFocusIndex] === item[idProperty]}'><div ng-bind-html='_createItemLabel(item)'></div><span class='ams_tick' ng-if='item[tickProperty] === true'></span></div><ul ng-if='item.sub'><li ng-repeat='item in item[groupProperty] | filter: not(_isHidden)' ng-include=\"'angular-multi-select-item.htm'\"></li></ul>";a.put("angular-multi-select-item.htm",b)}]),angular_multi_select.run(["$templateCache",function(a){"use strict";var b="<span class=\"ams\"><button class='ams_btn' type='button' ng-click='visible = !visible'><div class='ams_btn_template' ng-include src='buttonTemplate'></div></button>"+'<div class="ams_layer" ng-show="visible"><div class="ams_helpers_container" ng-if="helperStatus.filter || helperStatus.all || helperStatus.none || helperStatus.reset "><div class="ams_row" ng-if="helperStatus.all || helperStatus.none || helperStatus.reset "><button type="button" class="ams_helper_btn ams_selectall"ng-if="helperStatus.all" ng-click="selectAll()" ng-bind-html="lang.selectAll" set-focus="kbFocus[kbFocusIndex] === \'all\'""></button><button type="button" class="ams_helper_btn ams_selectnone"ng-if="helperStatus.none" ng-click="selectNone()" ng-bind-html="lang.selectNone" set-focus="kbFocus[kbFocusIndex] === \'none\'"></button><button type="button" class="ams_helper_btn reset ams_reset"ng-if="helperStatus.reset" ng-click="reset()" ng-bind-html="lang.reset" set-focus="kbFocus[kbFocusIndex] === \'reset\'"></button></div><div class="ams_row ams_search" ng-if="helperStatus.filter"><input placeholder="{{ lang.search }}" type="text"ng-model="searchInput.value" class="inputFilter ams_filter" set-focus="kbFocus[kbFocusIndex] === \'input\'"/><button type="button" class="ams_helper_btn ams_clear" ng-click="clear()" set-focus="kbFocus[kbFocusIndex] === \'clear\'"></button> </div> </div> <div class="ams_items_container"><ul><li ng-repeat=\'item in filteredModel | filter: not(_isHidden)\' ng-include="\'angular-multi-select-item.htm\'"></li></ul></div></div></div></span>';a.put("angular-multi-select.htm",b)}]);